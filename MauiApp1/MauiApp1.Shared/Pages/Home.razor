@page "/"
@using MauiApp1.Shared.Services
@inject IFormFactor FormFactor

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

<h2>Welcome to Blazor!</h2>

<!-- Master list -->
<table class="table">
    <thead>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Select</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var drucker in DruckerListe)
        {
            <tr class="@(SelectedDrucker?.Id == drucker.Id ? "table-primary" : "")">
                <td>@drucker.Id</td>
                <td>@drucker.Name</td>
                <td>
                    <button class="btn btn-sm btn-link"
                            @onclick="() => SelectDrucker(drucker)">
                        Select
                    </button>
                </td>
            </tr>
        }
    </tbody>
</table>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link @(activeTab=="calendar" ? "active" : "")"
           @onclick="@(() => activeTab = "checklist")">Calendar</a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(activeTab=="checklist" ? "active" : "")"
           @onclick="@(() => activeTab="checklist")">Checklist</a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(activeTab=="auftraege" ? "active" : "")"
           @onclick="@(() => activeTab="auftraege")">Aufträge</a>
    </li>
</ul>

<div class="tab-content">
    @if (activeTab == "calendar")
    {
        <div class="tab-pane active">
            <!-- Kalender-Komponente -->
            <CalendarComponent />
        </div>
    }
    else if (activeTab == "checklist")
    {
        <div class="tab-pane active">
            @foreach (var item in CheckListe)
            {
                <div>
                    <input type="checkbox" @bind="item.IsChecked" />
                    @item.Text
                </div>
            }
        </div>
    }
    else if (activeTab == "auftraege")
    {
        <div class="tab-pane active">
            <table class="table">
                @foreach (var auftrag in Auftraege)
                {
                    <tr>
                        <td>@auftrag.Id</td>
                        <td>@auftrag.DruckerId</td>
                        <td>@auftrag.ArtikelId</td>
                        <td>@auftrag.Status</td>
                    </tr>
                }
            </table>
        </div>
    }
</div>


Welcome to your new app running on <em>@factor</em> using <em>@platform</em>.

@code {
    private string factor => FormFactor.GetFormFactor();
    private string platform => FormFactor.GetPlatform();
}

@code {
    List<Drucker> DruckerListe = AuftragService.GetAllDrucker();
    Drucker? SelectedDrucker;
    List<Auftrag> Auftraege = new();
    string activeTab = "calendar";

    void SelectDrucker(Drucker drucker)
    {
        SelectedDrucker = drucker;
        LoadAuftraege(drucker.Id);
    }

    void LoadAuftraege(int druckerId)
    {
        // EF Core / Service call
        Auftraege = AuftragService.GetByDrucker(druckerId);
    }
    public class CheckItem
    {
        public string Text { get; set; } = "";
        public bool IsChecked { get; set; }
    }

    List<CheckItem> CheckListe = new()
    {
        new CheckItem { Text = "test", IsChecked = false },
        new CheckItem { Text = "noch eins", IsChecked = true },
        new CheckItem { Text = "drittes", IsChecked = false }
    };
}

